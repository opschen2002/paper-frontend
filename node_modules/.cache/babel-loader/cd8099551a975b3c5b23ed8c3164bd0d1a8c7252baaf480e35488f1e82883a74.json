{"ast":null,"code":"import { ref, computed, onMounted } from 'vue';\nimport ScoreCard from '@/components/common/ScoreCard.vue';\nimport { studentApi } from '@/api';\nimport { ElMessage } from 'element-plus';\nexport default {\n  name: 'StudentView',\n  components: {\n    ScoreCard\n  },\n  setup() {\n    const studentInfo = ref({});\n    const scoreData = ref({});\n    const loading = ref(false);\n    const error = ref(null);\n    const studentId = localStorage.getItem('username');\n    const hasStudentInfo = computed(() => Object.keys(studentInfo.value).length > 0);\n    const hasScoreData = computed(() => Object.keys(scoreData.value).length > 0);\n    const loadData = async () => {\n      if (!studentId) {\n        ElMessage.error('未找到学号信息，请重新登录');\n        return;\n      }\n      loading.value = true;\n      error.value = null;\n      try {\n        // 分开请求以便于单独处理错误\n        const info = await studentApi.getStudentInfo(studentId);\n        studentInfo.value = info;\n        try {\n          const score = await studentApi.getPersonalScore(studentId);\n          scoreData.value = score;\n        } catch (scoreError) {\n          console.error('获取成绩失败:', scoreError);\n          ElMessage.warning('获取成绩信息失败');\n        }\n      } catch (error) {\n        console.error('获取学生信息失败:', error);\n        ElMessage.error(error.message || '获取学生信息失败');\n        error.value = error;\n      } finally {\n        loading.value = false;\n      }\n    };\n    onMounted(loadData);\n    return {\n      studentInfo,\n      scoreData,\n      loading,\n      error,\n      hasStudentInfo,\n      hasScoreData\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","ScoreCard","studentApi","ElMessage","name","components","setup","studentInfo","scoreData","loading","error","studentId","localStorage","getItem","hasStudentInfo","Object","keys","value","length","hasScoreData","loadData","info","getStudentInfo","score","getPersonalScore","scoreError","console","warning","message"],"sources":["C:\\Users\\陈章宇\\Desktop\\test\\分步骤完成\\v7\\frontend\\paper-frontend\\src\\views\\student\\StudentView.vue"],"sourcesContent":["<template>\n  <div class=\"student-container\">\n    <el-row :gutter=\"20\" v-loading=\"loading\">\n      <el-col :span=\"8\">\n        <el-card v-if=\"hasStudentInfo\">\n          <template #header>\n            <h3>个人信息</h3>\n          </template>\n          <el-descriptions :column=\"1\" border>\n            <el-descriptions-item label=\"学号\">\n              {{ studentInfo.studentId }}\n            </el-descriptions-item>\n            <el-descriptions-item label=\"姓名\">\n              {{ studentInfo.name }}\n            </el-descriptions-item>\n            <el-descriptions-item label=\"班级\">\n              {{ studentInfo.className }}\n            </el-descriptions-item>\n            <el-descriptions-item label=\"学院\">\n              {{ studentInfo.college }}\n            </el-descriptions-item>\n          </el-descriptions>\n        </el-card>\n        <el-empty v-else description=\"暂无学生信息\" />\n      </el-col>\n      <el-col :span=\"16\">\n        <ScoreCard\n          v-if=\"hasScoreData\"\n          :score-data=\"scoreData\"\n          title=\"最新体测成绩\"\n        />\n        <el-empty v-else description=\"暂无成绩信息\" />\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from 'vue'\nimport ScoreCard from '@/components/common/ScoreCard.vue'\nimport { studentApi } from '@/api'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'StudentView',\n  components: { ScoreCard },\n  setup() {\n    const studentInfo = ref({})\n    const scoreData = ref({})\n    const loading = ref(false)\n    const error = ref(null)\n    \n    const studentId = localStorage.getItem('username')\n    \n    const hasStudentInfo = computed(() => Object.keys(studentInfo.value).length > 0)\n    const hasScoreData = computed(() => Object.keys(scoreData.value).length > 0)\n\n    const loadData = async () => {\n      if (!studentId) {\n        ElMessage.error('未找到学号信息，请重新登录')\n        return\n      }\n\n      loading.value = true\n      error.value = null\n\n      try {\n        // 分开请求以便于单独处理错误\n        const info = await studentApi.getStudentInfo(studentId)\n        studentInfo.value = info\n        \n        try {\n          const score = await studentApi.getPersonalScore(studentId)\n          scoreData.value = score\n        } catch (scoreError) {\n          console.error('获取成绩失败:', scoreError)\n          ElMessage.warning('获取成绩信息失败')\n        }\n      } catch (error) {\n        console.error('获取学生信息失败:', error)\n        ElMessage.error(error.message || '获取学生信息失败')\n        error.value = error\n      } finally {\n        loading.value = false\n      }\n    }\n\n    onMounted(loadData)\n\n    return {\n      studentInfo,\n      scoreData,\n      loading,\n      error,\n      hasStudentInfo,\n      hasScoreData\n    }\n  }\n}\n</script>\n\n<style scoped>\n.student-container {\n  padding: 20px;\n}\n</style>\n"],"mappings":"AAsCA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAQ,QAAS,KAAI;AAC7C,OAAOC,SAAQ,MAAO,mCAAkC;AACxD,SAASC,UAAS,QAAS,OAAM;AACjC,SAASC,SAAQ,QAAS,cAAa;AAEvC,eAAe;EACbC,IAAI,EAAE,aAAa;EACnBC,UAAU,EAAE;IAAEJ;EAAU,CAAC;EACzBK,KAAKA,CAAA,EAAG;IACN,MAAMC,WAAU,GAAIT,GAAG,CAAC,CAAC,CAAC;IAC1B,MAAMU,SAAQ,GAAIV,GAAG,CAAC,CAAC,CAAC;IACxB,MAAMW,OAAM,GAAIX,GAAG,CAAC,KAAK;IACzB,MAAMY,KAAI,GAAIZ,GAAG,CAAC,IAAI;IAEtB,MAAMa,SAAQ,GAAIC,YAAY,CAACC,OAAO,CAAC,UAAU;IAEjD,MAAMC,cAAa,GAAIf,QAAQ,CAAC,MAAMgB,MAAM,CAACC,IAAI,CAACT,WAAW,CAACU,KAAK,CAAC,CAACC,MAAK,GAAI,CAAC;IAC/E,MAAMC,YAAW,GAAIpB,QAAQ,CAAC,MAAMgB,MAAM,CAACC,IAAI,CAACR,SAAS,CAACS,KAAK,CAAC,CAACC,MAAK,GAAI,CAAC;IAE3E,MAAME,QAAO,GAAI,MAAAA,CAAA,KAAY;MAC3B,IAAI,CAACT,SAAS,EAAE;QACdR,SAAS,CAACO,KAAK,CAAC,eAAe;QAC/B;MACF;MAEAD,OAAO,CAACQ,KAAI,GAAI,IAAG;MACnBP,KAAK,CAACO,KAAI,GAAI,IAAG;MAEjB,IAAI;QACF;QACA,MAAMI,IAAG,GAAI,MAAMnB,UAAU,CAACoB,cAAc,CAACX,SAAS;QACtDJ,WAAW,CAACU,KAAI,GAAII,IAAG;QAEvB,IAAI;UACF,MAAME,KAAI,GAAI,MAAMrB,UAAU,CAACsB,gBAAgB,CAACb,SAAS;UACzDH,SAAS,CAACS,KAAI,GAAIM,KAAI;QACxB,EAAE,OAAOE,UAAU,EAAE;UACnBC,OAAO,CAAChB,KAAK,CAAC,SAAS,EAAEe,UAAU;UACnCtB,SAAS,CAACwB,OAAO,CAAC,UAAU;QAC9B;MACF,EAAE,OAAOjB,KAAK,EAAE;QACdgB,OAAO,CAAChB,KAAK,CAAC,WAAW,EAAEA,KAAK;QAChCP,SAAS,CAACO,KAAK,CAACA,KAAK,CAACkB,OAAM,IAAK,UAAU;QAC3ClB,KAAK,CAACO,KAAI,GAAIP,KAAI;MACpB,UAAU;QACRD,OAAO,CAACQ,KAAI,GAAI,KAAI;MACtB;IACF;IAEAjB,SAAS,CAACoB,QAAQ;IAElB,OAAO;MACLb,WAAW;MACXC,SAAS;MACTC,OAAO;MACPC,KAAK;MACLI,cAAc;MACdK;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}