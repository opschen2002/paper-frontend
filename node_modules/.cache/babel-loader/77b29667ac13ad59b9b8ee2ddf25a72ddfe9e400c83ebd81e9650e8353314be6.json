{"ast":null,"code":"import { ref, reactive } from 'vue';\nimport DataTable from '@/components/common/DataTable.vue';\nimport ScoreCard from '@/components/common/ScoreCard.vue';\nimport { adminApi } from '@/api';\nimport { ElMessage } from 'element-plus';\nexport default {\n  name: 'ScoresView',\n  components: {\n    DataTable,\n    ScoreCard\n  },\n  setup() {\n    const loading = ref(false);\n    const scoreList = ref([]);\n    const total = ref(0);\n    const dialogVisible = ref(false);\n    const currentScore = ref(null);\n    const queryForm = reactive({\n      studentId: '',\n      page: 1\n    });\n    const handleQuery = async () => {\n      try {\n        loading.value = true;\n        const res = await adminApi.getStudentScore(queryForm.studentId);\n        if (res) {\n          scoreList.value = [res];\n          total.value = 1;\n        }\n      } catch (error) {\n        ElMessage.error('查询失败');\n      } finally {\n        loading.value = false;\n      }\n    };\n    const handlePageChange = page => {\n      queryForm.page = page;\n      handleQuery();\n    };\n    const handleEdit = row => {\n      currentScore.value = row;\n      dialogVisible.value = true;\n    };\n    const handleUpdate = async data => {\n      try {\n        await adminApi.updateScore(data);\n        ElMessage.success('更新成功');\n        dialogVisible.value = false;\n        handleQuery();\n      } catch (error) {\n        ElMessage.error('更新失败');\n      }\n    };\n    return {\n      loading,\n      scoreList,\n      total,\n      queryForm,\n      dialogVisible,\n      currentScore,\n      handleQuery,\n      handlePageChange,\n      handleEdit,\n      handleUpdate\n    };\n  }\n};","map":{"version":3,"names":["ref","reactive","DataTable","ScoreCard","adminApi","ElMessage","name","components","setup","loading","scoreList","total","dialogVisible","currentScore","queryForm","studentId","page","handleQuery","value","res","getStudentScore","error","handlePageChange","handleEdit","row","handleUpdate","data","updateScore","success"],"sources":["C:\\Users\\陈章宇\\Desktop\\test\\分步骤完成\\v7\\frontend\\paper-frontend\\src\\views\\admin\\ScoresView.vue"],"sourcesContent":["<template>\n  <div class=\"scores-container\">\n    <DataTable\n      :loading=\"loading\"\n      :table-data=\"scoreList\"\n      :total=\"total\"\n      @page-change=\"handlePageChange\"\n    >\n      <template #header>\n        <el-form :inline=\"true\" :model=\"queryForm\">\n          <el-form-item label=\"学号\">\n            <el-input v-model=\"queryForm.studentId\" placeholder=\"请输入学号\" />\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"handleQuery\">查询</el-button>\n          </el-form-item>\n        </el-form>\n      </template>\n\n      <el-table-column prop=\"studentId\" label=\"学号\" />\n      <el-table-column prop=\"name\" label=\"姓名\" />\n      <el-table-column prop=\"className\" label=\"班级\" />\n      <el-table-column prop=\"totalScore\" label=\"总分\" />\n      <el-table-column label=\"操作\">\n        <template #default=\"{ row }\">\n          <el-button type=\"primary\" @click=\"handleEdit(row)\">编辑</el-button>\n        </template>\n      </el-table-column>\n    </DataTable>\n\n    <!-- 编辑对话框 -->\n    <el-dialog\n      v-model=\"dialogVisible\"\n      title=\"编辑成绩\"\n      width=\"50%\"\n    >\n      <ScoreCard\n        v-if=\"currentScore\"\n        :score-data=\"currentScore\"\n        :editable=\"true\"\n        @update=\"handleUpdate\"\n      />\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive } from 'vue'\nimport DataTable from '@/components/common/DataTable.vue'\nimport ScoreCard from '@/components/common/ScoreCard.vue'\nimport { adminApi } from '@/api'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'ScoresView',\n  components: { DataTable, ScoreCard },\n  setup() {\n    const loading = ref(false)\n    const scoreList = ref([])\n    const total = ref(0)\n    const dialogVisible = ref(false)\n    const currentScore = ref(null)\n    \n    const queryForm = reactive({\n      studentId: '',\n      page: 1\n    })\n\n    const handleQuery = async () => {\n      try {\n        loading.value = true\n        const res = await adminApi.getStudentScore(queryForm.studentId)\n        if (res) {\n          scoreList.value = [res]\n          total.value = 1\n        }\n      } catch (error) {\n        ElMessage.error('查询失败')\n      } finally {\n        loading.value = false\n      }\n    }\n\n    const handlePageChange = (page) => {\n      queryForm.page = page\n      handleQuery()\n    }\n\n    const handleEdit = (row) => {\n      currentScore.value = row\n      dialogVisible.value = true\n    }\n\n    const handleUpdate = async (data) => {\n      try {\n        await adminApi.updateScore(data)\n        ElMessage.success('更新成功')\n        dialogVisible.value = false\n        handleQuery()\n      } catch (error) {\n        ElMessage.error('更新失败')\n      }\n    }\n\n    return {\n      loading,\n      scoreList,\n      total,\n      queryForm,\n      dialogVisible,\n      currentScore,\n      handleQuery,\n      handlePageChange,\n      handleEdit,\n      handleUpdate\n    }\n  }\n}\n</script>"],"mappings":"AA+CA,SAASA,GAAG,EAAEC,QAAO,QAAS,KAAI;AAClC,OAAOC,SAAQ,MAAO,mCAAkC;AACxD,OAAOC,SAAQ,MAAO,mCAAkC;AACxD,SAASC,QAAO,QAAS,OAAM;AAC/B,SAASC,SAAQ,QAAS,cAAa;AAEvC,eAAe;EACbC,IAAI,EAAE,YAAY;EAClBC,UAAU,EAAE;IAAEL,SAAS;IAAEC;EAAU,CAAC;EACpCK,KAAKA,CAAA,EAAG;IACN,MAAMC,OAAM,GAAIT,GAAG,CAAC,KAAK;IACzB,MAAMU,SAAQ,GAAIV,GAAG,CAAC,EAAE;IACxB,MAAMW,KAAI,GAAIX,GAAG,CAAC,CAAC;IACnB,MAAMY,aAAY,GAAIZ,GAAG,CAAC,KAAK;IAC/B,MAAMa,YAAW,GAAIb,GAAG,CAAC,IAAI;IAE7B,MAAMc,SAAQ,GAAIb,QAAQ,CAAC;MACzBc,SAAS,EAAE,EAAE;MACbC,IAAI,EAAE;IACR,CAAC;IAED,MAAMC,WAAU,GAAI,MAAAA,CAAA,KAAY;MAC9B,IAAI;QACFR,OAAO,CAACS,KAAI,GAAI,IAAG;QACnB,MAAMC,GAAE,GAAI,MAAMf,QAAQ,CAACgB,eAAe,CAACN,SAAS,CAACC,SAAS;QAC9D,IAAII,GAAG,EAAE;UACPT,SAAS,CAACQ,KAAI,GAAI,CAACC,GAAG;UACtBR,KAAK,CAACO,KAAI,GAAI;QAChB;MACF,EAAE,OAAOG,KAAK,EAAE;QACdhB,SAAS,CAACgB,KAAK,CAAC,MAAM;MACxB,UAAU;QACRZ,OAAO,CAACS,KAAI,GAAI,KAAI;MACtB;IACF;IAEA,MAAMI,gBAAe,GAAKN,IAAI,IAAK;MACjCF,SAAS,CAACE,IAAG,GAAIA,IAAG;MACpBC,WAAW,CAAC;IACd;IAEA,MAAMM,UAAS,GAAKC,GAAG,IAAK;MAC1BX,YAAY,CAACK,KAAI,GAAIM,GAAE;MACvBZ,aAAa,CAACM,KAAI,GAAI,IAAG;IAC3B;IAEA,MAAMO,YAAW,GAAI,MAAOC,IAAI,IAAK;MACnC,IAAI;QACF,MAAMtB,QAAQ,CAACuB,WAAW,CAACD,IAAI;QAC/BrB,SAAS,CAACuB,OAAO,CAAC,MAAM;QACxBhB,aAAa,CAACM,KAAI,GAAI,KAAI;QAC1BD,WAAW,CAAC;MACd,EAAE,OAAOI,KAAK,EAAE;QACdhB,SAAS,CAACgB,KAAK,CAAC,MAAM;MACxB;IACF;IAEA,OAAO;MACLZ,OAAO;MACPC,SAAS;MACTC,KAAK;MACLG,SAAS;MACTF,aAAa;MACbC,YAAY;MACZI,WAAW;MACXK,gBAAgB;MAChBC,UAAU;MACVE;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}